from urllib.parse import urljoin

import requests
import lxml.html
import re

resp = requests.get("http://saturn.picoctf.net:58133/")
doc = lxml.html.fromstring(resp.content)
resource_urls = doc.xpath("/html/head/link[@rel='stylesheet']/@href|//script/@src")
comments = []
flag = None
for url in resource_urls:
    match = re.search(r"picoCTF\{.+\}", requests.get(urljoin(resp.url, url)).text, re.MULTILINE)
    if match:
        flag = match.group(0).strip()

assert flag

print(flag)
